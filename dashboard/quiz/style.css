Gemini

2.5 Flash


PRO


R

C


Conversation with Gemini
<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

Â  Â  <title>Fellowship Exams Pro - RadMentor</title>

Â  Â  <title>Fellowship Exams - RadMentor</title>

Â  Â  <!-- Sets the base path for all relative URLs to /dashboard/ -->

Â  Â  <base href="/dashboard/">

Â  Â Â 

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>

<script src="https://unpkg.com/feather-icons"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

Â  Â  <style>

Â  Â  Â  Â  :root {

Â  Â  Â  Â  Â  Â  --bg-color: #f8fafc; --container-bg-color: #ffffff; --text-color: #475569; --text-color-light: #6b7280;

Â  Â  Â  Â  Â  Â  --header-text-color: #111827; --primary-color: #4f46e5; --primary-hover-color: #4338ca;

Â  Â  Â  Â  Â  Â  --border-color: #e5e7eb; --explanation-bg: #f9fafb; --correct-bg: #f0fdf4; --correct-border: #86efac;

Â  Â  Â  Â  Â  Â  --correct-text: #15803d; --incorrect-bg: #fef2f2; --incorrect-border: #fca5a5; --incorrect-text: #b91c1c;

Â  Â  Â  Â  Â  Â  --bookmark-color: #9ca3af; --bookmarked-color: #f59e0b; --flag-color: #9ca3af; --flagged-color: #ef4444;

Â  Â  Â  Â  }

Â  Â  Â  Â  body { font-family: 'Inter', sans-serif; margin: 0; padding: 1.5rem; background-color: var(--bg-color); color: var(--text-color); }

Â  Â  Â  Â  .main-container { width: 100%; max-width: 900px; margin: 0 auto; }

Â  Â  Â  Â  .screen { display: none; width: 100%; }

Â  Â  Â  Â  .screen.active { display: block; animation: fadeIn 0.5s; }

Â  Â  Â  Â  @keyframes fadeIn { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }

Â  Â  Â  Â Â 

Â  Â  Â  Â  /* UPDATED: Auth Screen Style */

Â  Â  Â  Â  #authCheckScreen .selection-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 50vh; background: transparent; box-shadow: none; }

Â  Â  Â  Â  .loader { width: 40px; height: 40px; border: 4px solid var(--primary-color); border-bottom-color: transparent; border-radius: 50%; animation: rotation 1s linear infinite; }

Â  Â  Â  Â  @keyframes rotation { to { transform: rotate(360deg); } }



Â  Â  Â  Â  .selection-container { background-color: var(--container-bg-color); border-radius: 1.25rem; padding: 2rem; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }

Â  Â  Â  Â  .paper-button-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem; }

Â  Â  Â  Â  .paper-button { background-color: #f9fafb; color: var(--header-text-color); border: 1px solid var(--border-color); padding: 2rem; border-radius: 0.75rem; cursor: pointer; font-size: 1.25rem; font-weight: 700; transition: all 0.2s ease-in-out; }

Â  Â  Â  Â  .paper-button:hover { background-color: var(--primary-color); color: white; transform: translateY(-5px); box-shadow: 0 6px 15px rgba(79, 70, 229, 0.2); border-color: var(--primary-color); }

Â  Â  Â  Â  .quiz-container, .results-container { background-color: var(--container-bg-color); border-radius: 1.25rem; box-shadow: 0 6px 20px rgba(0,0,0,0.05); overflow: hidden; }

Â  Â  Â  Â  .quiz-header { padding: 1rem 1.25rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; gap: 1rem; }

Â  Â  Â  Â  .quiz-header h1 { font-size: 1.25rem; margin: 0; color: var(--header-text-color); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

Â  Â  Â  Â  .header-controls { display: flex; align-items: center; gap: 1rem; }

Â  Â  Â  Â  .timer { font-size: 1.1rem; font-weight: 600; color: var(--primary-color); background-color: #eef2ff; padding: 0.5rem 1rem; border-radius: 0.5rem; }

Â  Â  Â  Â Â 

Â  Â  Â  Â  /* NEW: Mode Toggle Switch Styles */

Â  Â  Â  Â  .mode-toggle { display: flex; align-items: center; gap: 0.75rem; font-size: 0.9rem; font-weight: 500; }

Â  Â  Â  Â  .switch { position: relative; display: inline-block; width: 50px; height: 28px; }

Â  Â  Â  Â  .switch input { opacity: 0; width: 0; height: 0; }

Â  Â  Â  Â  .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; border-radius: 28px; transition: 0.4s; }

Â  Â  Â  Â  .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; border-radius: 50%; transition: 0.4s; }

Â  Â  Â  Â  input:checked + .slider { background-color: var(--primary-color); }

Â  Â  Â  Â  input:checked + .slider:before { transform: translateX(22px); }



Â  Â  Â  Â  .question-area { padding: 1.5rem; }

Â  Â  Â  Â  .question-title-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }

Â  Â  Â  Â  .question-number { font-size: 1rem; font-weight: 500; color: var(--text-color-light); }

Â  Â  Â  Â  .question-controls { display: flex; gap: 1rem; }

Â  Â  Â  Â  .icon-btn { background: none; border: none; cursor: pointer; padding: 0; color: var(--text-color-light); transition: color 0.2s; }

Â  Â  Â  Â  .icon-btn:hover { color: var(--header-text-color); }

Â  Â  Â  Â  .icon-btn svg { width: 22px; height: 22px; }

Â  Â  Â  Â  .bookmark-btn.bookmarked { color: var(--bookmarked-color); }

Â  Â  Â  Â  .flag-btn.flagged { color: var(--flagged-color); }

Â  Â  Â  Â  .main-question-text { font-size: 1.2rem; font-weight: 600; line-height: 1.6; margin-bottom: 1.5rem; }

Â  Â  Â  Â  .option-btn { display: block; width: 100%; text-align: left; padding: 1rem; margin-bottom: 0.75rem; border: 1px solid var(--border-color); border-radius: 0.75rem; background-color: #f9fafb; cursor: pointer; transition: all 0.2s; }

Â  Â  Â  Â  .option-btn:hover { border-color: var(--primary-color); background-color: #eef2ff; }

Â  Â  Â  Â  .option-btn.selected { border-color: var(--primary-color); background-color: #eef2ff; font-weight: 600; }

Â  Â  Â  Â  .option-btn.correct { background-color: var(--correct-bg); border-color: var(--correct-border); color: var(--correct-text); font-weight: 600; }

Â  Â  Â  Â  .option-btn.incorrect { background-color: var(--incorrect-bg); border-color: var(--incorrect-border); color: var(--incorrect-text); font-weight: 600; }

Â  Â  Â  Â  .quiz-pagination-header { background-color: #f9fafb; padding: 1rem; border-bottom: 1px solid var(--border-color); overflow-x: auto; white-space: nowrap; scrollbar-width: thin; scrollbar-color: var(--primary-color) var(--border-color); }

Â  Â  Â  Â  .page-box { display: inline-flex; width: 40px; height: 40px; align-items: center; justify-content: center; font-weight: 600; background-color: #fff; border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s ease; border-radius: 0.5rem; position: relative; margin-right: 0.5rem; }

Â  Â  Â  Â  .page-box.active { border-color: var(--primary-color); background-color: var(--primary-color); color: white; transform: scale(1.1); }

Â  Â  Â  Â  .page-box.answered-correct { background-color: var(--correct-bg); border-color: var(--correct-border); color: var(--correct-text); }

Â  Â  Â  Â  .page-box.answered-incorrect { background-color: var(--incorrect-bg); border-color: var(--incorrect-border); color: var(--incorrect-text); }

Â  Â  Â  Â  .page-box.flagged::after { content: ''; position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background-color: var(--flagged-color); border-radius: 50%; }

Â  Â  Â  Â  .explanation-box { margin-top: 1.5rem; padding: 1.5rem; background-color: var(--explanation-bg); border-radius: 0.75rem; border-left: 4px solid var(--primary-color); }

Â  Â  Â  Â  .results-container { padding: 2rem; }

Â  Â  Â  Â  .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }

Â  Â  Â  Â  .stat-card { background-color: #f9fafb; padding: 1.5rem; border-radius: 0.75rem; border: 1px solid var(--border-color); }

Â  Â  Â  Â  .stat-card h3 { font-size: 1.1rem; font-weight: 600; color: var(--header-text-color); border-bottom: 1px solid var(--border-color); padding-bottom: 0.75rem; margin-bottom: 1rem; }

Â  Â  Â  Â Â 

Â  Â  Â  Â  /* UPDATED: Results Buttons Styles */

Â  Â  Â  Â  .results-actions { text-align: center; margin-top: 2.5rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; }

Â  Â  Â  Â  .results-btn { padding: 0.75rem 1.5rem; font-weight: 600; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s; border: 1px solid transparent; text-decoration: none; display: inline-block; }

Â  Â  Â  Â  .results-btn.primary { background-color: var(--primary-color); color: white; }

Â  Â  Â  Â  .results-btn.primary:hover { background-color: var(--primary-hover-color); }

Â  Â  Â  Â  .results-btn.secondary { background-color: var(--container-bg-color); color: var(--text-color); border-color: var(--border-color); }

Â  Â  Â  Â  .results-btn.secondary:hover { background-color: var(--bg-color); }

Â  Â  Â  Â  .results-btn.danger { background-color: var(--incorrect-text); color: white; }

Â  Â  Â  Â  .results-btn.danger:hover { background-color: #991b1b; }

Â  Â  Â  Â  .results-btn.warning { background-color: var(--bookmarked-color); color: white; }

Â  Â  Â  Â  .results-btn.warning:hover { background-color: #d97706; }



Â  Â  </style>

Â  Â  <!-- This will correctly resolve to /dashboard/quiz/style.css -->

Â  Â  <link rel="stylesheet" href="quiz/style.css">

</head>

<body>

Â  Â  <!-- Auth Screen: Shown while checking login status -->

<div id="authCheckScreen" class="screen active">

<div class="selection-container">

<div class="loader"></div>

<p style="margin-top: 1rem; font-weight: 500; color: var(--text-color-light);">Initializing Session...</p>

</div>

</div>



Â  Â  <!-- Main Container for the app -->

<div class="main-container">

Â  Â  Â  Â  <!-- Topic/Paper Selection Screen -->

<div id="topic-screen" class="screen">

<div class="selection-container">

Â  Â  Â  Â  Â  Â  Â  Â  Â <h1 style="color: var(--header-text-color); font-size: 2.2rem; font-weight: 800;">Gear Up for Success</h1>

Â  Â  Â  Â  Â  Â  Â  Â  Â <h1 style="color: var(--header-text-color); font-size: 2.2rem; font-weight: 800;">Fellowship Exams</h1>

<p style="color: var(--text-color-light); font-size: 1.1rem; max-width: 600px; margin: 1rem auto 0;">Excel in the top fellowship exams from around the world with our curated question papers.</p>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="paper-card-grid" class="paper-button-grid"></div>

Â  Â  Â  Â  Â  Â  Â  Â  Â <div id="paper-card-grid" class="paper-button-grid"></div>

</div>

</div>



Â  Â  Â  Â  <!-- Quiz Screen -->

<div id="quiz-screen" class="screen">

<div class="quiz-container">

<div id="loading-container" style="text-align:center; padding: 4rem;"><div class="loader"></div></div>

@@ -131,465 +62,55 @@ <h1 id="quiz-title"></h1>

</div>

</div>



Â  Â  Â  Â  <!-- Results Screen -->

<div id="results-screen" class="screen"></div>

</div>



Â  Â  <!-- Audio elements -->

<audio id="correct-sound" src="https://cdn.jsdelivr.net/gh/im2famous4u/RadMentor@main/sounds/correct.mp3" preload="auto"></audio>

<audio id="wrong-sound" src="https://cdn.jsdelivr.net/gh/im2famous4u/RadMentor@main/sounds/wrong.mp3" preload="auto"></audio>



Â  Â  <script type="module">

Â  Â  Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";

Â  Â  Â  Â  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

Â  Â  Â  Â  import { getFirestore, doc, runTransaction, collection, getDocs, setDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

Â  Â  Â  Â  import { GoogleGenerativeAI } from "https://cdn.jsdelivr.net/npm/@google/generative-ai/+esm";

Â  Â  <!-- This will correctly resolve to /dashboard/quiz/quiz-engine.js -->

Â  Â  <script type="module" src="quiz/quiz-engine.js"></script>



Â  Â  Â  Â  // --- CONFIGURATION ---

Â  Â  Â  Â  const GOOGLE_AI_API_KEY = 'YOUR_API_KEY_HERE';

Â  Â  Â  Â  const ALL_QUIZ_DATA = {

Â  Â  Â  Â  Â  Â  Â paper1: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "0" }, paper2: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1141721868" },

Â  Â  Â  Â  Â  Â  Â paper3: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1815658253" }, paper4: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1386284317" },

Â  Â  Â  Â  Â  Â  Â paper5: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "40352700" }, paper6: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "54400073" },

Â  Â  Â  Â  Â  Â  Â paper7: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1767827630" }, paper8: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "280434470" }

Â  Â  <!-- Initialize the engine with THIS quiz's specific data -->

Â  Â  <script type="module">

Â  Â  Â  Â  import { initQuizApp } from './quiz/quiz-engine.js';



Â  Â  Â  Â  // 1. DEFINE THE DATA FOR THIS SPECIFIC QUIZ

Â  Â  Â  Â  const fellowshipQuizData = {

Â  Â  Â  Â  Â  Â  paper1: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "0" },

Â  Â  Â  Â  Â  Â  paper2: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1141721868" },

Â  Â  Â  Â  Â  Â  paper3: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1815658253" },

Â  Â  Â  Â  Â  Â  paper4: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1386284317" },

Â  Â  Â  Â  Â  Â  paper5: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "40352700" },

Â  Â  Â  Â  Â  Â  paper6: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "54400073" },

Â  Â  Â  Â  Â  Â  paper7: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "1767827630" },

Â  Â  Â  Â  Â  Â  paper8: { sheetId: "13bIVTjrFwqcP0Q7WitSvb3ksy7g9XWXrq4uLOQwzLmo", gid: "280434470" }

};

Â  Â  Â  Â  const PAPER_METADATA = [

Â  Â  Â  Â  Â  Â  Â { id: 'paper1', name: 'Paper 1'}, { id: 'paper2', name: 'Paper 2'},

Â  Â  Â  Â  Â  Â  Â { id: 'paper3', name: 'Paper 3'}, { id: 'paper4', name: 'Paper 4'},

Â  Â  Â  Â  Â  Â  Â { id: 'paper5', name: 'Paper 5'}, { id: 'paper6', name: 'Paper 6'},

Â  Â  Â  Â  Â  Â  Â { id: 'paper7', name: 'Paper 7'}, { id: 'paper8', name: 'Paper 8'},



Â  Â  Â  Â  const fellowshipPaperMetadata = [

Â  Â  Â  Â  Â  Â  { id: 'paper1', name: 'Paper 1', type: 'mcq'}, { id: 'paper2', name: 'Paper 2', type: 'mcq'},

Â  Â  Â  Â  Â  Â  { id: 'paper3', name: 'Paper 3', type: 'mcq'}, { id: 'paper4', name: 'Paper 4', type: 'mcq'},

Â  Â  Â  Â  Â  Â  { id: 'paper5', name: 'Paper 5', type: 'mcq'}, { id: 'paper6', name: 'Paper 6', type: 'mcq'},

Â  Â  Â  Â  Â  Â  { id: 'paper7', name: 'Paper 7', type: 'mcq'}, { id: 'paper8', name: 'Paper 8', type: 'mcq'},

];

Â  Â  Â  Â Â 

const firebaseConfig = {

apiKey: "AIzaSyD-OTIwv6P88eT2PCPJXiHgZEDgFV8ZcSw", authDomain: "radiology-mcqs.firebaseapp.com", projectId: "radiology-mcqs",

storageBucket: "radiology-mcqs.appspot.com", messagingSenderId: "862300415358", appId: "1:862300415358:web:097d5e413f388e30587f2f"

};

Â  Â  Â  Â Â 

Â  Â  Â  Â  // --- APP STATE & INITIALIZATION ---

Â  Â  Â  Â  let allQuestions = [], currentQuestionIndex = 0, currentUser = null;

Â  Â  Â  Â  let userBookmarks = new Set(), flaggedQuestions = new Set(), reviewFilter = [];

Â  Â  Â  Â  let currentPaper = null, quizMode = 'practice', quizInterval = null, elapsedSeconds = 0;

Â  Â  Â  Â  let userAnswers = {};

Â  Â  Â  Â  let isReviewing = false;

Â  Â  Â  Â  let isSoundOn = true;

Â  Â  Â  Â  const app = initializeApp(firebaseConfig);

Â  Â  Â  Â  const auth = getAuth(app);

Â  Â  Â  Â  const db = getFirestore(app);

Â  Â  Â  Â  const dom = {

Â  Â  Â  Â  Â  Â  Â screens: document.querySelectorAll('.screen'), paperCardGrid: document.getElementById('paper-card-grid'), quizTitle: document.getElementById('quiz-title'),

Â  Â  Â  Â  Â  Â  Â loadingContainer: document.getElementById('loading-container'), questionsDisplay: document.getElementById('questions-display'), quizContent: document.getElementById('quiz-content'),

Â  Â  Â  Â  Â  Â  Â paginationHeader: document.getElementById('quiz-pagination-header'), timerEl: document.getElementById('timer'), resultsScreen: document.getElementById('results-screen'),

Â  Â  Â  Â  Â  Â  Â finishQuizBtn: document.getElementById('finish-quiz-btn'),

Â  Â  Â  Â  Â  Â  Â soundToggleBtn: document.getElementById('sound-toggle-btn'), correctSound: document.getElementById('correct-sound'), wrongSound: document.getElementById('wrong-sound'),

Â  Â  Â  Â  Â  Â  Â modeToggle: document.getElementById('mode-toggle-checkbox') // NEW

Â  Â  Â  Â  };

Â  Â  Â  Â Â 

Â  Â  Â  Â  // --- AUTH & NAVIGATION ---

Â  Â  Â  Â  function showScreen(screenId) { dom.screens.forEach(s => s.classList.toggle('active', s.id === screenId)); feather.replace(); }

Â  Â  Â  Â Â 

Â  Â  Â  Â  onAuthStateChanged(auth, (user) => {

Â  Â  Â  Â  Â  Â  const authCheckScreen = document.getElementById('authCheckScreen');

Â  Â  Â  Â  Â  Â  currentUser = user;

Â  Â  Â  Â  Â  Â  if (user) {

Â  Â  Â  Â  Â  Â  Â  Â  authCheckScreen.style.display = 'none';

Â  Â  Â  Â  Â  Â  Â  Â  handleDirectLink(user);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â authCheckScreen.innerHTML = '<div class="selection-container"><p>You must be logged in to continue.</p></div>';

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  });



Â  Â  Â  Â  function handleDirectLink(user) {

Â  Â  Â  Â  Â  Â  const urlParams = new URLSearchParams(window.location.search);

Â  Â  Â  Â  Â  Â  const directQuestionId = urlParams.get('questionId');

Â  Â  Â  Â  Â  Â  if(user && directQuestionId) {

Â  Â  Â  Â  Â  Â  Â  Â  const paperId = urlParams.get('paperId');

Â  Â  Â  Â  Â  Â  Â  Â  const paper = PAPER_METADATA.find(p => p.id === paperId);

Â  Â  Â  Â  Â  Â  Â  Â  if(paper) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentPaper = paper;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  quizMode = 'practice';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startQuiz(null, directQuestionId);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;Â 

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  showScreen('topic-screen');

Â  Â  Â  Â  Â  Â  dom.paperCardGrid.innerHTML = PAPER_METADATA.map(paper => `<button class="paper-button" data-id="${paper.id}" data-name="${paper.name}">${paper.name}</button>`).join('');

Â  Â  Â  Â  }



Â  Â  Â  Â  dom.paperCardGrid.addEventListener('click', (e) => {

Â  Â  Â  Â  Â  Â  if (e.target.matches('.paper-button')) {

Â  Â  Â  Â  Â  Â  Â  Â  const { id, name } = e.target.dataset;

Â  Â  Â  Â  Â  Â  Â  Â  currentPaper = { id, name };

Â  Â  Â  Â  Â  Â  Â  Â  quizMode = 'practice';

Â  Â  Â  Â  Â  Â  Â  Â  checkResumeAndStart();

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  });



Â  Â  Â  Â  dom.modeToggle.addEventListener('change', () => {

Â  Â  Â  Â  Â  Â  const newMode = dom.modeToggle.checked ? 'exam' : 'practice';

Â  Â  Â  Â  Â  Â  if (confirm(`Switching to ${newMode} mode will restart your progress for this paper. Continue?`)) {

Â  Â  Â  Â  Â  Â  Â  Â  setQuizMode(newMode);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  dom.modeToggle.checked = !dom.modeToggle.checked;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  });

Â  Â  Â  Â Â 

Â  Â  Â  Â  function setQuizMode(newMode) {

Â  Â  Â  Â  Â  Â  quizMode = newMode;

Â  Â  Â  Â  Â  Â  localStorage.removeItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  Â  Â  Â  Â  startQuiz(null);

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  function checkResumeAndStart() {

Â  Â  Â  Â  Â  Â  const savedState = localStorage.getItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  Â  Â  Â  Â  if (savedState) {

Â  Â  Â  Â  Â  Â  Â  Â  if (confirm(`You have an unfinished ${quizMode} session. Resume?`)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startQuiz(JSON.parse(savedState));

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startQuiz(null);

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  startQuiz(null);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  async function startQuiz(resumeState, directQuestionId = null) {

Â  Â  Â  Â  Â  Â  isReviewing = false; reviewFilter = [];

Â  Â  Â  Â  Â  Â  userAnswers = resumeState?.answers || {};

Â  Â  Â  Â  Â  Â  currentQuestionIndex = resumeState?.index || 0;

Â  Â  Â  Â  Â  Â  elapsedSeconds = resumeState?.elapsedSeconds || 0;

Â  Â  Â  Â  Â  Â  flaggedQuestions = new Set(resumeState?.flags || []);

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  showScreen('quiz-screen');

Â  Â  Â  Â  Â  Â  dom.loadingContainer.style.display = 'block';

Â  Â  Â  Â  Â  Â  dom.quizContent.style.display = 'none';

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  initializeSound();

Â  Â  Â  Â  Â  Â  await Promise.all([fetchQuizData(), fetchUserBookmarks()]);



Â  Â  Â  Â  Â  Â  dom.modeToggle.checked = quizMode === 'exam';



Â  Â  Â  Â  Â  Â  dom.loadingContainer.style.display = 'none';

Â  Â  Â  Â  Â  Â  dom.quizContent.style.display = 'block';

Â  Â  Â  Â  Â  Â  dom.quizTitle.textContent = `${currentPaper.name}`;

Â  Â  Â  Â  Â  Â  dom.finishQuizBtn.textContent = 'Finish';

Â  Â  Â  Â  Â  Â  dom.finishQuizBtn.style.display = 'block';

Â  Â  Â  Â  Â  Â  createQuestionNav();



Â  Â  Â  Â  Â  Â  if (directQuestionId) {

Â  Â  Â  Â  Â  Â  Â  Â  const questionIndex = allQuestions.findIndex(q => q.id === directQuestionId);

Â  Â  Â  Â  Â  Â  Â  Â  showQuestion(questionIndex >= 0 ? questionIndex : 0);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  showQuestion(currentQuestionIndex);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  startTimer();

Â  Â  Â  Â  }



Â  Â  Â  Â  async function fetchQuizData() {

Â  Â  Â  Â  Â  Â  const paperData = ALL_QUIZ_DATA[currentPaper.id];

Â  Â  Â  Â  Â  Â  const url = `https://docs.google.com/spreadsheets/d/${paperData.sheetId}/gviz/tq?tqx=out:csv&gid=${paperData.gid}`;

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(url);

Â  Â  Â  Â  Â  Â  Â  Â  const csvText = await response.text();

Â  Â  Â  Â  Â  Â  Â  Â  allQuestions = parseCSVToQuestions(csvText);

Â  Â  Â  Â  Â  Â  } catch (error) { console.error("Fetch Error:", error); }

Â  Â  Â  Â  }



Â  Â  Â  Â  function parseCSVToQuestions(csvText) {

Â  Â  Â  Â  Â  Â  const lines = csvText.trim().split('\n').slice(1);

Â  Â  Â  Â  Â  Â  return lines.map((line, index) => {

Â  Â  Â  Â  Â  Â  Â  Â  const parts = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(p => p.trim().replace(/^"|"$/g, ''));

Â  Â  Â  Â  Â  Â  Â  Â  const [question, a, b, c, d, correctAns, explanation] = parts;

Â  Â  Â  Â  Â  Â  Â  Â  const options = [a, b, c, d].filter(Boolean);

Â  Â  Â  Â  Â  Â  Â  Â  const letterMap = {'a': 0, 'b': 1, 'c': 2, 'd': 3};

Â  Â  Â  Â  Â  Â  Â  Â  const correctIndex = letterMap[(correctAns || '').trim().toLowerCase()];

Â  Â  Â  Â  Â  Â  Â  Â  if (question && correctIndex !== undefined && options.length > 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return { id: `${currentPaper.id}-${index}`, text: question, options, correctIndex, explanation: explanation || "N/A" };

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  return null;

Â  Â  Â  Â  Â  Â  }).filter(Boolean);

Â  Â  Â  Â  }



Â  Â  Â  Â  async function fetchUserBookmarks() {

Â  Â  Â  Â  Â  Â  if (!currentUser) return;

Â  Â  Â  Â  Â  Â  const bookmarksRef = collection(db, "users", currentUser.uid, "bookmarks");

Â  Â  Â  Â  Â  Â  const snapshot = await getDocs(bookmarksRef);

Â  Â  Â  Â  Â  Â  userBookmarks = new Set(snapshot.docs.map(doc => doc.id));

Â  Â  Â  Â  }



Â  Â  Â  Â  function showQuestion(index) {

Â  Â  Â  Â  Â  Â  if (reviewFilter.length > 0 && !reviewFilter.includes(index)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â index = reviewFilter.find(i => i >= index) || reviewFilter[0];

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  currentQuestionIndex = index;

Â  Â  Â  Â  Â  Â  const q = allQuestions[index];

Â  Â  Â  Â  Â  Â  if (!q) return;



Â  Â  Â  Â  Â  Â  const isBookmarked = userBookmarks.has(q.id);

Â  Â  Â  Â  Â  Â  const isFlagged = flaggedQuestions.has(q.id);

Â  Â  Â  Â  Â  Â  const isAnswered = userAnswers[index] !== undefined;



Â  Â  Â  Â  Â  Â  let questionHTML = `

Â  Â  Â  Â  Â  Â  Â  Â  <div class="question-title-bar">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="question-number">Question ${index + 1} of ${allQuestions.length}</span>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="question-controls">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn flag-btn ${isFlagged ? 'flagged' : ''}" onclick="window.toggleFlag('${q.id}')" ${isReviewing ? 'disabled' : ''}><i data-feather="flag"></i></button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn bookmark-btn ${isBookmarked ? 'bookmarked' : ''}" onclick="window.toggleBookmark('${q.id}', '${q.text.replace(/'/g, "\\'")}')" ${isReviewing ? 'disabled' : ''}><i data-feather="bookmark"></i></button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <p class="main-question-text">${q.text}</p>

Â  Â  Â  Â  Â  Â  Â  Â  <div>${q.options.map((option, i) => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const shouldDisable = isReviewing || (quizMode === 'practice' && isAnswered);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let btnClass = 'option-btn';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (quizMode === 'exam' && i === userAnswers[index]) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btnClass += ' selected';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (shouldDisable && i === q.correctIndex) btnClass += ' correct';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (shouldDisable && i === userAnswers[index]) btnClass += ' incorrect';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<button class="${btnClass}" data-index="${i}" ${shouldDisable ? 'disabled' : ''}>${option}</button>`;

Â  Â  Â  Â  Â  Â  Â  Â  }).join('')}</div>`;

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  if ((quizMode === 'practice' && isAnswered) || isReviewing) {

Â  Â  Â  Â  Â  Â  Â  Â  questionHTML += `<div class="explanation-box"><h4>Explanation</h4><p>${q.explanation}</p></div>`;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  dom.questionsDisplay.innerHTML = questionHTML;

Â  Â  Â  Â  Â  Â  if (!isReviewing && !(quizMode === 'practice' && isAnswered)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â dom.questionsDisplay.querySelectorAll('.option-btn').forEach(btn => btn.addEventListener('click', handleOptionClick));

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  updateQuestionNav();

Â  Â  Â  Â  Â  Â  feather.replace();

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  function handleOptionClick(e) {

Â  Â  Â  Â  Â  Â  const selectedIndex = parseInt(e.target.dataset.index);

Â  Â  Â  Â  Â  Â  userAnswers[currentQuestionIndex] = selectedIndex;

Â  Â  Â  Â  Â  Â  const q = allQuestions[currentQuestionIndex];

Â  Â  Â  Â  Â  Â  const isCorrect = selectedIndex === q.correctIndex;



Â  Â  Â  Â  Â  Â  if (quizMode === 'practice') {

Â  Â  Â  Â  Â  Â  Â  Â  if(isSoundOn) (isCorrect ? dom.correctSound : dom.wrongSound).play();

Â  Â  Â  Â  Â  Â  Â  Â  showQuestion(currentQuestionIndex);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  showQuestion(currentQuestionIndex);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  saveState();

Â  Â  Â  Â  }



Â  Â  Â  Â  function createQuestionNav() {

Â  Â  Â  Â  Â  Â  dom.paginationHeader.innerHTML = allQuestions.map((_, i) => `<div class="page-box" data-index="${i}">${i + 1}</div>`).join('');

Â  Â  Â  Â  Â  Â  dom.paginationHeader.querySelectorAll('.page-box').forEach(box => box.addEventListener('click', () => showQuestion(parseInt(box.dataset.index))));

Â  Â  Â  Â  }



Â  Â  Â  Â  function updateQuestionNav() {

Â  Â  Â  Â  Â  Â  dom.paginationHeader.querySelectorAll('.page-box').forEach(box => {

Â  Â  Â  Â  Â  Â  Â  Â  const index = parseInt(box.dataset.index);

Â  Â  Â  Â  Â  Â  Â  Â  box.className = 'page-box';

Â  Â  Â  Â  Â  Â  Â  Â  if (index === currentQuestionIndex) box.classList.add('active');

Â  Â  Â  Â  Â  Â  Â  Â  if (userAnswers[index] !== undefined) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (quizMode === 'practice' || isReviewing) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isCorrect = userAnswers[index] === allQuestions[index].correctIndex;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  box.classList.add(isCorrect ? 'answered-correct' : 'answered-incorrect');

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â box.classList.add('answered-correct');

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â box.style.backgroundColor = 'var(--primary-color)';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â box.style.borderColor = 'var(--primary-color)';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â box.style.color = 'white';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  if (flaggedQuestions.has(allQuestions[index].id)) box.classList.add('flagged');

Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const activeBox = dom.paginationHeader.querySelector('.page-box.active');

Â  Â  Â  Â  Â  Â  if(activeBox) activeBox.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  function initializeSound() {

Â  Â  Â  Â  Â  Â  const savedSoundPref = localStorage.getItem('radmentor_sound_pref');

Â  Â  Â  Â  Â  Â  isSoundOn = savedSoundPref !== 'off';

Â  Â  Â  Â  Â  Â  updateSoundIcon();

Â  Â  Â  Â  }



Â  Â  Â  Â  window.toggleSound = () => {

Â  Â  Â  Â  Â  Â  isSoundOn = !isSoundOn;

Â  Â  Â  Â  Â  Â  localStorage.setItem('radmentor_sound_pref', isSoundOn ? 'on' : 'off');

Â  Â  Â  Â  Â  Â  updateSoundIcon();

Â  Â  Â  Â  };



Â  Â  Â  Â  function updateSoundIcon() {

Â  Â  Â  Â  Â  Â  const iconName = isSoundOn ? 'volume-2' : 'volume-x';

Â  Â  Â  Â  Â  Â  dom.soundToggleBtn.innerHTML = `<i data-feather="${iconName}"></i>`;

Â  Â  Â  Â  Â  Â  feather.replace();

Â  Â  Â  Â  }

Â  Â  Â  Â  dom.soundToggleBtn.addEventListener('click', window.toggleSound);



Â  Â  Â  Â  window.toggleFlag = (id) => { flaggedQuestions.has(id) ? flaggedQuestions.delete(id) : flaggedQuestions.add(id); updateQuestionNav(); saveState(); };

Â  Â  Â  Â Â 

Â  Â  Â  Â  window.toggleBookmark = async (questionId, questionText) => {

Â  Â  Â  Â  Â  Â  if (!currentUser) return;

Â  Â  Â  Â  Â  Â  const bookmarkRef = doc(db, "users", currentUser.uid, "bookmarks", questionId);

Â  Â  Â  Â  Â  Â  const button = event.currentTarget;

Â  Â  Â  Â  Â  Â  if (userBookmarks.has(questionId)) {

Â  Â  Â  Â  Â  Â  Â  Â  await deleteDoc(bookmarkRef);

Â  Â  Â  Â  Â  Â  Â  Â  userBookmarks.delete(questionId);

Â  Â  Â  Â  Â  Â  Â  Â  button.classList.remove('bookmarked');

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  await setDoc(bookmarkRef, { questionText, topic: `Fellowship ${currentPaper.name}`, timestamp: serverTimestamp(), linkToQuestion: `${window.location.pathname}?paperId=${currentPaper.id}&questionId=${questionId}` });

Â  Â  Â  Â  Â  Â  Â  Â  userBookmarks.add(questionId);

Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('bookmarked');

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  // 2. CREATE THE CONFIGURATION OBJECT

Â  Â  Â  Â  const config = {

Â  Â  Â  Â  Â  Â  ALL_QUIZ_DATA: fellowshipQuizData,

Â  Â  Â  Â  Â  Â  PAPER_METADATA: fellowshipPaperMetadata,

Â  Â  Â  Â  Â  Â  FIREBASE_CONFIG: firebaseConfig,

Â  Â  Â  Â  Â  Â  GOOGLE_AI_API_KEY: 'YOUR_API_KEY_HERE' // Or load it securely

};

Â  Â  Â  Â Â 

Â  Â  Â  Â  dom.finishQuizBtn.addEventListener('click', () => {

Â  Â  Â  Â  Â  Â  Â if (quizMode === 'exam') {

Â  Â  Â  Â  Â  Â  Â  Â  if(confirm('Are you sure you want to finish the exam?')) finishExam();

Â  Â  Â  Â  Â  Â  Â } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â if(confirm('Are you sure you want to finish this practice session?')) finishExam();

Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  });



Â  Â  Â  Â  async function finishExam() {

Â  Â  Â  Â  Â  Â  clearInterval(quizInterval);

Â  Â  Â  Â  Â  Â  showScreen('results-screen');

Â  Â  Â  Â  Â  Â  let correctCount = 0, incorrectCount = 0;

Â  Â  Â  Â  Â  Â  const incorrectQuestions = [];



Â  Â  Â  Â  Â  Â  allQuestions.forEach((q, i) => {

Â  Â  Â  Â  Â  Â  Â  Â  if (userAnswers[i] !== undefined) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(userAnswers[i] === q.correctIndex) correctCount++; else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  incorrectCount++;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  incorrectQuestions.push(q);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  const unattemptedCount = allQuestions.length - (correctCount + incorrectCount);

Â  Â  Â  Â  Â  Â  const scorePercent = allQuestions.length > 0 ? (correctCount / allQuestions.length * 100) : 0;



Â  Â  Â  Â  Â  Â  dom.resultsScreen.innerHTML = `

Â  Â  Â  Â  Â  Â  Â  <div class="results-container">

Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="font-size: 2.2rem; font-weight: 700; color: var(--header-text-color);">Test Results</h2>

Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="results-grid" style="margin-top: 2rem;">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card"><h3>Score Summary</h3><p style="font-size: 3rem; font-weight: 700; color: var(--primary-color);" id="final-score-percent"></p><p><strong>Correct:</strong> <span id="correct-count"></span></p><p><strong>Incorrect:</strong> <span id="incorrect-count"></span></p><p><strong>Unattempted:</strong> <span id="unattempted-count"></span></p></div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card"><h3>Performance Chart</h3><canvas id="performanceChart" style="max-height: 200px;"></canvas></div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card"><h3>Peer Comparison</h3><div id="peer-comparison-content"><p><strong>Average Score:</strong> <span id="average-score">Calculating...</span></p><p><strong>Your Rank:</strong> You scored higher than <span id="percentile-rank">Calculating...</span>% of users.</p></div></div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="display: flex; justify-content: space-between; align-items: center;"><span>ðŸ¤– RadMentor Insights</span><span style="background-color: #ef4444; color: white; font-size: 0.65rem; font-weight: 700; padding: 3px 8px; border-radius: 99px; text-transform: uppercase;">Exclusive</span></h3>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="ai-insights-content"><p>Generating feedback...</p></div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="results-actions">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="results-btn primary" id="review-all-btn">Review All</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="results-btn danger" id="review-incorrect-btn">Review Incorrect</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="results-btn warning" id="review-flagged-btn">Review Flagged</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="results-btn secondary" id="back-to-topics-btn">Back to Papers</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  </div>`;

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  document.getElementById('final-score-percent').textContent = `${scorePercent.toFixed(1)}%`;

Â  Â  Â  Â  Â  Â  document.getElementById('correct-count').textContent = correctCount;

Â  Â  Â  Â  Â  Â  document.getElementById('incorrect-count').textContent = incorrectCount;

Â  Â  Â  Â  Â  Â  document.getElementById('unattempted-count').textContent = unattemptedCount;

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  if(window.performanceChart instanceof Chart) window.performanceChart.destroy();

Â  Â  Â  Â  Â  Â  window.performanceChart = new Chart(document.getElementById('performanceChart'), { type: 'doughnut', data: { labels: ['Correct', 'Incorrect', 'Unattempted'], datasets: [{ data: [correctCount, incorrectCount, unattemptedCount], backgroundColor: ['#22c55e', '#ef4444', '#f59e0b'] }]}});

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  localStorage.removeItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  if (quizMode === 'exam') {

Â  Â  Â  Â  Â  Â  Â  Â  const attemptData = { score: correctCount, total: allQuestions.length };

Â  Â  Â  Â  Â  Â  Â  Â  const { average, percentile } = await saveTestResultAndGetStats(attemptData);

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('average-score').textContent = `${average.toFixed(1)}%`;

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('percentile-rank').textContent = percentile.toFixed(1);

Â  Â  Â  Â  Â  Â  Â  Â  getAIInsights(incorrectQuestions);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('peer-comparison-content').innerHTML = '<p>Peer comparison is only available in Exam Mode.</p>';

Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('ai-insights-content').innerHTML = '<p>AI Insights are only available for Exam Mode results.</p>';

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  document.getElementById('back-to-topics-btn').addEventListener('click', () => { showScreen('topic-screen'); handleDirectLink(currentUser); });

Â  Â  Â  Â  Â  Â  document.getElementById('review-all-btn').addEventListener('click', () => setupReview('all'));

Â  Â  Â  Â  Â  Â  document.getElementById('review-incorrect-btn').addEventListener('click', () => setupReview('incorrect'));

Â  Â  Â  Â  Â  Â  document.getElementById('review-flagged-btn').addEventListener('click', () => setupReview('flagged'));

Â  Â  Â  Â  }



Â  Â  Â  Â  async function saveTestResultAndGetStats(attempt) {

Â  Â  Â  Â  Â  Â  const aggregatesRef = doc(db, "quizAggregates", currentPaper.id);

Â  Â  Â  Â  Â  Â  let finalStats = { average: 0, percentile: 0 };

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  await runTransaction(db, async (transaction) => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const aggDoc = await transaction.get(aggregatesRef);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const scorePercent = allQuestions.length > 0 ? (attempt.score / allQuestions.length) * 100 : 0;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!aggDoc.exists()) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transaction.set(aggregatesRef, { totalAttempts: 1, averageScore: scorePercent, scores: [scorePercent] });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  finalStats = { average: scorePercent, percentile: 100 };

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = aggDoc.data();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const scores = data.scores || [];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  finalStats.percentile = scores.length > 0 ? (scores.filter(s => s < scorePercent).length / scores.length) * 100 : 100;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newTotalAttempts = data.totalAttempts + 1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newAverageScore = ((data.averageScore * data.totalAttempts) + scorePercent) / newTotalAttempts;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scores.push(scorePercent);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transaction.update(aggregatesRef, { totalAttempts: newTotalAttempts, averageScore: newAverageScore, scores });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  finalStats.average = newAverageScore;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  } catch (e) { console.error("Transaction failed: ", e); }

Â  Â  Â  Â  Â  Â  return finalStats;

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  async function getAIInsights(incorrectQs) {

Â  Â  Â  Â  Â  Â  const insightsDiv = document.getElementById('ai-insights-content');

Â  Â  Â  Â  Â  Â  if (GOOGLE_AI_API_KEY === 'YOUR_API_KEY_HERE') {

Â  Â  Â  Â  Â  Â  Â  Â  insightsDiv.innerHTML = '<p>AI features are not enabled. Please add a Google AI API key.</p>'; return;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if(incorrectQs.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â insightsDiv.innerHTML = '<p>Flawless victory! No incorrect answers to analyze.</p>'; return;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  const genAI = new GoogleGenerativeAI(GOOGLE_AI_API_KEY);

Â  Â  Â  Â  Â  Â  Â  Â  const model = genAI.getGenerativeModel({ model: "gemini-pro"});

Â  Â  Â  Â  Â  Â  Â  Â  const prompt = `A user answered these radiology fellowship exam questions incorrectly. Identify 2-3 core concepts they are struggling with and give concise, actionable study advice. Questions:\n${incorrectQs.map(q => `- ${q.text}`).join('\n')}`;

Â  Â  Â  Â  Â  Â  Â  Â  const result = await model.generateContent(prompt);

Â  Â  Â  Â  Â  Â  Â  Â  insightsDiv.innerHTML = result.response.text().replace(/\n/g, '<br>').replace(/\*/g, '');

Â  Â  Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  Â  Â  Â  insightsDiv.innerHTML = '<p>Could not retrieve AI insights at this time.</p>';

Â  Â  Â  Â  Â  Â  Â  Â  console.error("AI Error:", error);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  function saveState() {

Â  Â  Â  Â  Â  Â  Â if (!currentUser || !currentPaper || isReviewing) return;

Â  Â  Â  Â  Â  Â  Â const state = { answers: userAnswers, index: currentQuestionIndex, elapsedSeconds: elapsedSeconds, flags: Array.from(flaggedQuestions) };

Â  Â  Â  Â  Â  Â  Â localStorage.setItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`, JSON.stringify(state));

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  function startTimer() {

Â  Â  Â  Â  Â  Â  clearInterval(quizInterval);

Â  Â  Â  Â  Â  Â  let startTime = Date.now() - (elapsedSeconds * 1000);

Â  Â  Â  Â  Â  Â  quizInterval = setInterval(() => {

Â  Â  Â  Â  Â  Â  Â  Â  elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);

Â  Â  Â  Â  Â  Â  Â  Â  dom.timerEl.textContent = `${String(Math.floor(elapsedSeconds/60)).padStart(2,'0')}:${String(elapsedSeconds%60).padStart(2,'0')}`;

Â  Â  Â  Â  Â  Â  }, 1000);

Â  Â  Â  Â  }



Â  Â  Â  Â  function setupReview(filterType) {

Â  Â  Â  Â  Â  Â  isReviewing = true;

Â  Â  Â  Â  Â  Â  if (filterType === 'all') {

Â  Â  Â  Â  Â  Â  Â  Â  reviewFilter = allQuestions.map((_, i) => i);

Â  Â  Â  Â  Â  Â  } else if (filterType === 'incorrect') {

Â  Â  Â  Â  Â  Â  Â  Â  reviewFilter = allQuestions.map((q, i) => i).filter(i => userAnswers[i] !== undefined && userAnswers[i] !== q.correctIndex);

Â  Â  Â  Â  Â  Â  } else if (filterType === 'flagged') {

Â  Â  Â  Â  Â  Â  Â  Â  reviewFilter = allQuestions.map((q, i) => i).filter(i => flaggedQuestions.has(q.id));

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  if (reviewFilter.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  alert(`No ${filterType} questions to review.`);

Â  Â  Â  Â  Â  Â  Â  Â  isReviewing = false;

Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  dom.finishQuizBtn.style.display = 'none';

Â  Â  Â  Â  Â  Â  showScreen('quiz-screen');

Â  Â  Â  Â  Â  Â  createQuestionNav();

Â  Â  Â  Â  Â  Â  showQuestion(reviewFilter[0]);

Â  Â  Â  Â  }

Â  Â  Â  Â  // 3. START THE APP

Â  Â  Â  Â  initQuizApp(config);

</script>

</body>

</html> dashboard/fellowship-exams.html code 1 just take it sont say anything im giving my codes



I've received your code.






import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";

import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

import { getFirestore, doc, runTransaction, collection, getDocs, setDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

import { GoogleGenerativeAI } from "https://cdn.jsdelivr.net/npm/@google/generative-ai/+esm";



// --- CONFIGURATION (to be provided by the specific quiz HTML) ---

let QUIZ_CONFIG = {

Â  Â  GOOGLE_AI_API_KEY: 'YOUR_API_KEY_HERE',

Â  Â  ALL_QUIZ_DATA: {},

Â  Â  PAPER_METADATA: [],

Â  Â  FIREBASE_CONFIG: {}

};



// --- APP STATE & INITIALIZATION ---

let allQuestions = [], currentQuestionIndex = 0, currentUser = null;

let userBookmarks = new Set(), flaggedQuestions = new Set(), reviewFilter = [];

let currentPaper = null, quizMode = 'practice', quizInterval = null, elapsedSeconds = 0;

let userAnswers = {};

let isReviewing = false;

let isSoundOn = true;

let db, auth;



const dom = {

Â  Â  screens: document.querySelectorAll('.screen'), paperCardGrid: document.getElementById('paper-card-grid'), quizTitle: document.getElementById('quiz-title'),

Â  Â  loadingContainer: document.getElementById('loading-container'), questionsDisplay: document.getElementById('questions-display'), quizContent: document.getElementById('quiz-content'),

Â  Â  paginationHeader: document.getElementById('quiz-pagination-header'), timerEl: document.getElementById('timer'), resultsScreen: document.getElementById('results-screen'),

Â  Â  finishQuizBtn: document.getElementById('finish-quiz-btn'),

Â  Â  soundToggleBtn: document.getElementById('sound-toggle-btn'), correctSound: document.getElementById('correct-sound'), wrongSound: document.getElementById('wrong-sound'),

Â  Â  modeToggle: document.getElementById('mode-toggle-checkbox')

};



/**

Â * The main entry point for initializing the quiz application.

Â * This function is exported and called from specific quiz HTML files.

Â * @param {object} config - The configuration object for the quiz.

Â */

export function initQuizApp(config) {

Â  Â  QUIZ_CONFIG = { ...QUIZ_CONFIG, ...config };



Â  Â  const app = initializeApp(QUIZ_CONFIG.FIREBASE_CONFIG);

Â  Â  auth = getAuth(app);

Â  Â  db = getFirestore(app);



Â  Â  onAuthStateChanged(auth, (user) => {

Â  Â  Â  Â  const authCheckScreen = document.getElementById('authCheckScreen');

Â  Â  Â  Â  currentUser = user;

Â  Â  Â  Â  if (user) {

Â  Â  Â  Â  Â  Â  authCheckScreen.style.display = 'none';

Â  Â  Â  Â  Â  Â  handleDirectLink(user);

Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  authCheckScreen.innerHTML = '<div class="selection-container"><p>You must be logged in to continue.</p></div>';

Â  Â  Â  Â  }

Â  Â  });



Â  Â  // Attach initial event listeners

Â  Â  dom.paperCardGrid.addEventListener('click', (e) => {

Â  Â  Â  Â  if (e.target.matches('.paper-button')) {

Â  Â  Â  Â  Â  Â  const { id, name } = e.target.dataset;

Â  Â  Â  Â  Â  Â  currentPaper = { id, name };

Â  Â  Â  Â  Â  Â  quizMode = 'practice';

Â  Â  Â  Â  Â  Â  checkResumeAndStart();

Â  Â  Â  Â  }

Â  Â  });



Â  Â  dom.modeToggle.addEventListener('change', () => {

Â  Â  Â  Â  const newMode = dom.modeToggle.checked ? 'exam' : 'practice';

Â  Â  Â  Â  if (confirm(`Switching to ${newMode} mode will restart your progress for this paper. Continue?`)) {

Â  Â  Â  Â  Â  Â  setQuizMode(newMode);

Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  dom.modeToggle.checked = !dom.modeToggle.checked;

Â  Â  Â  Â  }

Â  Â  });



Â  Â  dom.soundToggleBtn.addEventListener('click', toggleSound);

Â  Â Â 

Â  Â  dom.finishQuizBtn.addEventListener('click', () => {

Â  Â  Â  Â if (quizMode === 'exam') {

Â  Â  Â  Â  Â  Â if(confirm('Are you sure you want to finish the exam?')) finishExam();

Â  Â  Â  Â } else {

Â  Â  Â  Â  Â  Â if(confirm('Are you sure you want to finish this practice session?')) finishExam();

Â  Â  Â  Â }

Â  Â  });

}



// ... All other functions from the previous response are copied here ...

// For brevity, I am not re-pasting all 20+ functions, but you would

// have the full, unchanged quiz-engine.js file from the previous step here.

// No changes are required within this file for it to work in a subdirectory.

function showScreen(screenId) {

Â  Â  dom.screens.forEach(s => s.classList.toggle('active', s.id === screenId));

Â  Â  feather.replace();

}



function handleDirectLink(user) {

Â  Â  const urlParams = new URLSearchParams(window.location.search);

Â  Â  const directQuestionId = urlParams.get('questionId');

Â  Â  if(user && directQuestionId) {

Â  Â  Â  Â  const paperId = urlParams.get('paperId');

Â  Â  Â  Â  const paper = QUIZ_CONFIG.PAPER_METADATA.find(p => p.id === paperId);

Â  Â  Â  Â  if(paper) {

Â  Â  Â  Â  Â  Â  currentPaper = paper;

Â  Â  Â  Â  Â  Â  quizMode = 'practice';

Â  Â  Â  Â  Â  Â  startQuiz(null, directQuestionId);

Â  Â  Â  Â  Â  Â  return;Â 

Â  Â  Â  Â  }

Â  Â  }

Â  Â  showScreen('topic-screen');

Â  Â  dom.paperCardGrid.innerHTML = QUIZ_CONFIG.PAPER_METADATA.map(paper => `<button class="paper-button" data-id="${paper.id}" data-name="${paper.name}">${paper.name}</button>`).join('');

}



function setQuizMode(newMode) {

Â  Â  quizMode = newMode;

Â  Â  localStorage.removeItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  startQuiz(null);

}



function checkResumeAndStart() {

Â  Â  const savedState = localStorage.getItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  if (savedState) {

Â  Â  Â  Â  if (confirm(`You have an unfinished ${quizMode} session. Resume?`)) {

Â  Â  Â  Â  Â  Â  startQuiz(JSON.parse(savedState));

Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  localStorage.removeItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â  Â  Â  Â  Â  startQuiz(null);

Â  Â  Â  Â  }

Â  Â  } else {

Â  Â  Â  Â  startQuiz(null);

Â  Â  }

}



async function startQuiz(resumeState, directQuestionId = null) {

Â  Â  isReviewing = false; reviewFilter = [];

Â  Â  userAnswers = resumeState?.answers || {};

Â  Â  currentQuestionIndex = resumeState?.index || 0;

Â  Â  elapsedSeconds = resumeState?.elapsedSeconds || 0;

Â  Â  flaggedQuestions = new Set(resumeState?.flags || []);

Â  Â Â 

Â  Â  showScreen('quiz-screen');

Â  Â  dom.loadingContainer.style.display = 'block';

Â  Â  dom.quizContent.style.display = 'none';

Â  Â Â 

Â  Â  initializeSound();

Â  Â  await Promise.all([fetchQuizData(), fetchUserBookmarks()]);



Â  Â  dom.modeToggle.checked = quizMode === 'exam';



Â  Â  dom.loadingContainer.style.display = 'none';

Â  Â  dom.quizContent.style.display = 'block';

Â  Â  dom.quizTitle.textContent = `${currentPaper.name}`;

Â  Â  dom.finishQuizBtn.textContent = 'Finish';

Â  Â  dom.finishQuizBtn.style.display = 'block';

Â  Â  createQuestionNav();



Â  Â  if (directQuestionId) {

Â  Â  Â  Â  const questionIndex = allQuestions.findIndex(q => q.id === directQuestionId);

Â  Â  Â  Â  showQuestion(questionIndex >= 0 ? questionIndex : 0);

Â  Â  } else {

Â  Â  Â  Â  showQuestion(currentQuestionIndex);

Â  Â  }

Â  Â  startTimer();

}



async function fetchQuizData() {

Â  Â  const paperData = QUIZ_CONFIG.ALL_QUIZ_DATA[currentPaper.id];

Â  Â  const url = `https://docs.google.com/spreadsheets/d/${paperData.sheetId}/gviz/tq?tqx=out:csv&gid=${paperData.gid}`;

Â  Â  try {

Â  Â  Â  Â  const response = await fetch(url);

Â  Â  Â  Â  const csvText = await response.text();

Â  Â  Â  Â  allQuestions = parseCSVToQuestions(csvText);

Â  Â  } catch (error) { console.error("Fetch Error:", error); }

}



function parseCSVToQuestions(csvText) {

Â  Â  const lines = csvText.trim().split('\n').slice(1);

Â  Â  return lines.map((line, index) => {

Â  Â  Â  Â  const parts = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(p => p.trim().replace(/^"|"$/g, ''));

Â  Â  Â  Â  const [question, a, b, c, d, correctAns, explanation] = parts;

Â  Â  Â  Â  const options = [a, b, c, d].filter(Boolean);

Â  Â  Â  Â  const letterMap = {'a': 0, 'b': 1, 'c': 2, 'd': 3};

Â  Â  Â  Â  const correctIndex = letterMap[(correctAns || '').trim().toLowerCase()];

Â  Â  Â  Â  if (question && correctIndex !== undefined && options.length > 0) {

Â  Â  Â  Â  Â  Â  return { id: `${currentPaper.id}-${index}`, text: question, options, correctIndex, explanation: explanation || "N/A" };

Â  Â  Â  Â  }

Â  Â  Â  Â  return null;

Â  Â  }).filter(Boolean);

}



async function fetchUserBookmarks() {

Â  Â  if (!currentUser) return;

Â  Â  const bookmarksRef = collection(db, "users", currentUser.uid, "bookmarks");

Â  Â  const snapshot = await getDocs(bookmarksRef);

Â  Â  userBookmarks = new Set(snapshot.docs.map(doc => doc.id));

}



function showQuestion(index) {

Â  Â  if (reviewFilter.length > 0 && !reviewFilter.includes(index)) {

Â  Â  Â  Â  index = reviewFilter.find(i => i >= index) || reviewFilter[0];

Â  Â  }

Â  Â  currentQuestionIndex = index;

Â  Â  const q = allQuestions[index];

Â  Â  if (!q) return;



Â  Â  const isBookmarked = userBookmarks.has(q.id);

Â  Â  const isFlagged = flaggedQuestions.has(q.id);

Â  Â  const isAnswered = userAnswers[index] !== undefined;



Â  Â  let questionHTML = `

Â  Â  Â  Â  <div class="question-title-bar">

Â  Â  Â  Â  Â  Â  <span class="question-number">Question ${index + 1} of ${allQuestions.length}</span>

Â  Â  Â  Â  Â  Â  <div class="question-controls">

Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn flag-btn ${isFlagged ? 'flagged' : ''}" ${isReviewing ? 'disabled' : ''}><i data-feather="flag"></i></button>

Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn bookmark-btn ${isBookmarked ? 'bookmarked' : ''}" ${isReviewing ? 'disabled' : ''}><i data-feather="bookmark"></i></button>

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <p class="main-question-text">${q.text}</p>

Â  Â  Â  Â  <div>${q.options.map((option, i) => {

Â  Â  Â  Â  Â  Â  const shouldDisable = isReviewing || (quizMode === 'practice' && isAnswered);

Â  Â  Â  Â  Â  Â  let btnClass = 'option-btn';

Â  Â  Â  Â  Â  Â  if (quizMode === 'exam' && i === userAnswers[index]) {

Â  Â  Â  Â  Â  Â  Â  Â  btnClass += ' selected';

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (shouldDisable && i === q.correctIndex) btnClass += ' correct';

Â  Â  Â  Â  Â  Â  else if (shouldDisable && i === userAnswers[index]) btnClass += ' incorrect';

Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  return `<button class="${btnClass}" data-index="${i}" ${shouldDisable ? 'disabled' : ''}>${option}</button>`;

Â  Â  Â  Â  }).join('')}</div>`;

Â  Â Â 

Â  Â  if ((quizMode === 'practice' && isAnswered) || isReviewing) {

Â  Â  Â  Â  questionHTML += `<div class="explanation-box"><h4>Explanation</h4><p>${q.explanation}</p></div>`;

Â  Â  }



Â  Â  dom.questionsDisplay.innerHTML = questionHTML;



Â  Â  // Attach event listeners programmatically instead of using onclick in HTML

Â  Â  const flagBtn = dom.questionsDisplay.querySelector('.flag-btn');

Â  Â  if (flagBtn) flagBtn.addEventListener('click', () => toggleFlag(q.id));



Â  Â  const bookmarkBtn = dom.questionsDisplay.querySelector('.bookmark-btn');

Â  Â  if (bookmarkBtn) bookmarkBtn.addEventListener('click', () => toggleBookmark(q.id, q.text));



Â  Â  if (!isReviewing && !(quizMode === 'practice' && isAnswered)) {

Â  Â  Â  Â  dom.questionsDisplay.querySelectorAll('.option-btn').forEach(btn => btn.addEventListener('click', handleOptionClick));

Â  Â  }

Â  Â  updateQuestionNav();

Â  Â  feather.replace();

}



function handleOptionClick(e) {

Â  Â  const selectedIndex = parseInt(e.target.dataset.index);

Â  Â  userAnswers[currentQuestionIndex] = selectedIndex;

Â  Â  const q = allQuestions[currentQuestionIndex];

Â  Â  const isCorrect = selectedIndex === q.correctIndex;



Â  Â  if (quizMode === 'practice') {

Â  Â  Â  Â  if(isSoundOn) (isCorrect ? dom.correctSound : dom.wrongSound).play();

Â  Â  Â  Â  showQuestion(currentQuestionIndex);

Â  Â  } else {

Â  Â  Â  Â  showQuestion(currentQuestionIndex);

Â  Â  }

Â  Â  saveState();

}



function createQuestionNav() {

Â  Â  dom.paginationHeader.innerHTML = allQuestions.map((_, i) => `<div class="page-box" data-index="${i}">${i + 1}</div>`).join('');

Â  Â  dom.paginationHeader.querySelectorAll('.page-box').forEach(box => box.addEventListener('click', () => showQuestion(parseInt(box.dataset.index))));

}



function updateQuestionNav() {

Â  Â  dom.paginationHeader.querySelectorAll('.page-box').forEach(box => {

Â  Â  Â  Â  const index = parseInt(box.dataset.index);

Â  Â  Â  Â  box.className = 'page-box';

Â  Â  Â  Â  if (index === currentQuestionIndex) box.classList.add('active');

Â  Â  Â  Â  if (userAnswers[index] !== undefined) {

Â  Â  Â  Â  Â  Â  Â if (quizMode === 'practice' || isReviewing) {

Â  Â  Â  Â  Â  Â  Â  Â  Â const isCorrect = userAnswers[index] === allQuestions[index].correctIndex;

Â  Â  Â  Â  Â  Â  Â  Â  Â box.classList.add(isCorrect ? 'answered-correct' : 'answered-incorrect');

Â  Â  Â  Â  Â  Â  Â } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â box.classList.add('answered-correct');

Â  Â  Â  Â  Â  Â  Â  Â  Â box.style.backgroundColor = 'var(--primary-color)';

Â  Â  Â  Â  Â  Â  Â  Â  Â box.style.borderColor = 'var(--primary-color)';

Â  Â  Â  Â  Â  Â  Â  Â  Â box.style.color = 'white';

Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  }

Â  Â  Â  Â  if (flaggedQuestions.has(allQuestions[index].id)) box.classList.add('flagged');

Â  Â  });

Â  Â  const activeBox = dom.paginationHeader.querySelector('.page-box.active');

Â  Â  if(activeBox) activeBox.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });

}



function initializeSound() {

Â  Â  const savedSoundPref = localStorage.getItem('radmentor_sound_pref');

Â  Â  isSoundOn = savedSoundPref !== 'off';

Â  Â  updateSoundIcon();

}



function toggleSound() {

Â  Â  isSoundOn = !isSoundOn;

Â  Â  localStorage.setItem('radmentor_sound_pref', isSoundOn ? 'on' : 'off');

Â  Â  updateSoundIcon();

}



function updateSoundIcon() {

Â  Â  const iconName = isSoundOn ? 'volume-2' : 'volume-x';

Â  Â  dom.soundToggleBtn.innerHTML = `<i data-feather="${iconName}"></i>`;

Â  Â  feather.replace();

}



function toggleFlag(id) {

Â  Â  flaggedQuestions.has(id) ? flaggedQuestions.delete(id) : flaggedQuestions.add(id);

Â  Â  document.querySelector(`.flag-btn`).classList.toggle('flagged', flaggedQuestions.has(id));

Â  Â  updateQuestionNav();

Â  Â  saveState();

}



async function toggleBookmark(questionId, questionText) {

Â  Â  if (!currentUser) return;

Â  Â  const bookmarkRef = doc(db, "users", currentUser.uid, "bookmarks", questionId);

Â  Â  const button = dom.questionsDisplay.querySelector('.bookmark-btn');

Â  Â Â 

Â  Â  if (userBookmarks.has(questionId)) {

Â  Â  Â  Â  await deleteDoc(bookmarkRef);

Â  Â  Â  Â  userBookmarks.delete(questionId);

Â  Â  Â  Â  button.classList.remove('bookmarked');

Â  Â  } else {

Â  Â  Â  Â  await setDoc(bookmarkRef, { questionText, topic: `Fellowship ${currentPaper.name}`, timestamp: serverTimestamp(), linkToQuestion: `${window.location.pathname}?paperId=${currentPaper.id}&questionId=${questionId}` });

Â  Â  Â  Â  userBookmarks.add(questionId);

Â  Â  Â  Â  button.classList.add('bookmarked');

Â  Â  }

}



async function finishExam() {

Â  Â  clearInterval(quizInterval);

Â  Â  showScreen('results-screen');

Â  Â  let correctCount = 0, incorrectCount = 0;

Â  Â  const incorrectQuestions = [];



Â  Â  allQuestions.forEach((q, i) => {

Â  Â  Â  Â  if (userAnswers[i] !== undefined) {

Â  Â  Â  Â  Â  Â  if(userAnswers[i] === q.correctIndex) correctCount++; else {

Â  Â  Â  Â  Â  Â  Â  Â  incorrectCount++;

Â  Â  Â  Â  Â  Â  Â  Â  incorrectQuestions.push(q);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  });



Â  Â  const unattemptedCount = allQuestions.length - (correctCount + incorrectCount);

Â  Â  const scorePercent = allQuestions.length > 0 ? (correctCount / allQuestions.length * 100) : 0;



Â  Â  dom.resultsScreen.innerHTML = `

Â  Â  Â  <div class="results-container">

Â  Â  Â  Â  Â  <h2 style="font-size: 2.2rem; font-weight: 700; color: var(--header-text-color);">Test Results</h2>

Â  Â  Â  Â  Â  <div class="results-grid" style="margin-top: 2rem;">

Â  Â  Â  Â  Â  Â  Â  <div class="stat-card"><h3>Score Summary</h3><p style="font-size: 3rem; font-weight: 700; color: var(--primary-color);" id="final-score-percent"></p><p><strong>Correct:</strong> <span id="correct-count"></span></p><p><strong>Incorrect:</strong> <span id="incorrect-count"></span></p><p><strong>Unattempted:</strong> <span id="unattempted-count"></span></p></div>

Â  Â  Â  Â  Â  Â  Â  <div class="stat-card"><h3>Performance Chart</h3><canvas id="performanceChart" style="max-height: 200px;"></canvas></div>

Â  Â  Â  Â  Â  Â  Â  <div class="stat-card"><h3>Peer Comparison</h3><div id="peer-comparison-content"><p><strong>Average Score:</strong> <span id="average-score">Calculating...</span></p><p><strong>Your Rank:</strong> You scored higher than <span id="percentile-rank">Calculating...</span>% of users.</p></div></div>

Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">

Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="display: flex; justify-content: space-between; align-items: center;"><span>ðŸ¤– RadMentor Insights</span><span style="background-color: #ef4444; color: white; font-size: 0.65rem; font-weight: 700; padding: 3px 8px; border-radius: 99px; text-transform: uppercase;">Exclusive</span></h3>

Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="ai-insights-content"><p>Generating feedback...</p></div>

Â  Â  Â  Â  Â  Â  Â </div>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="results-actions">

Â  Â  Â  Â  Â  Â  Â  <button class="results-btn primary" id="review-all-btn">Review All</button>

Â  Â  Â  Â  Â  Â  Â  <button class="results-btn danger" id="review-incorrect-btn">Review Incorrect</button>

Â  Â  Â  Â  Â  Â  Â  <button class="results-btn warning" id="review-flagged-btn">Review Flagged</button>

Â  Â  Â  Â  Â  Â  Â  <button class="results-btn secondary" id="back-to-topics-btn">Back to Papers</button>

Â  Â  Â  Â  Â  </div>

Â  Â  Â  </div>`;

Â  Â Â 

Â  Â  document.getElementById('final-score-percent').textContent = `${scorePercent.toFixed(1)}%`;

Â  Â  document.getElementById('correct-count').textContent = correctCount;

Â  Â  document.getElementById('incorrect-count').textContent = incorrectCount;

Â  Â  document.getElementById('unattempted-count').textContent = unattemptedCount;

Â  Â Â 

Â  Â  if(window.performanceChart instanceof Chart) window.performanceChart.destroy();

Â  Â  window.performanceChart = new Chart(document.getElementById('performanceChart'), { type: 'doughnut', data: { labels: ['Correct', 'Incorrect', 'Unattempted'], datasets: [{ data: [correctCount, incorrectCount, unattemptedCount], backgroundColor: ['#22c55e', '#ef4444', '#f59e0b'] }]}});

Â  Â Â 

Â  Â  localStorage.removeItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`);

Â  Â Â 

Â  Â  if (quizMode === 'exam') {

Â  Â  Â  Â  const attemptData = { score: correctCount, total: allQuestions.length };

Â  Â  Â  Â  const { average, percentile } = await saveTestResultAndGetStats(attemptData);

Â  Â  Â  Â  document.getElementById('average-score').textContent = `${average.toFixed(1)}%`;

Â  Â  Â  Â  document.getElementById('percentile-rank').textContent = percentile.toFixed(1);

Â  Â  Â  Â  getAIInsights(incorrectQuestions);

Â  Â  } else {

Â  Â  Â  Â  document.getElementById('peer-comparison-content').innerHTML = '<p>Peer comparison is only available in Exam Mode.</p>';

Â  Â  Â  Â  document.getElementById('ai-insights-content').innerHTML = '<p>AI Insights are only available for Exam Mode results.</p>';

Â  Â  }



Â  Â  document.getElementById('back-to-topics-btn').addEventListener('click', () => { showScreen('topic-screen'); handleDirectLink(currentUser); });

Â  Â  document.getElementById('review-all-btn').addEventListener('click', () => setupReview('all'));

Â  Â  document.getElementById('review-incorrect-btn').addEventListener('click', () => setupReview('incorrect'));

Â  Â  document.getElementById('review-flagged-btn').addEventListener('click', () => setupReview('flagged'));

}



async function saveTestResultAndGetStats(attempt) {

Â  Â  const aggregatesRef = doc(db, "quizAggregates", currentPaper.id);

Â  Â  let finalStats = { average: 0, percentile: 0 };

Â  Â  try {

Â  Â  Â  Â  await runTransaction(db, async (transaction) => {

Â  Â  Â  Â  Â  Â  const aggDoc = await transaction.get(aggregatesRef);

Â  Â  Â  Â  Â  Â  const scorePercent = allQuestions.length > 0 ? (attempt.score / allQuestions.length) * 100 : 0;

Â  Â  Â  Â  Â  Â  if (!aggDoc.exists()) {

Â  Â  Â  Â  Â  Â  Â  Â  transaction.set(aggregatesRef, { totalAttempts: 1, averageScore: scorePercent, scores: [scorePercent] });

Â  Â  Â  Â  Â  Â  Â  Â  finalStats = { average: scorePercent, percentile: 100 };

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  const data = aggDoc.data();

Â  Â  Â  Â  Â  Â  Â  Â  const scores = data.scores || [];

Â  Â  Â  Â  Â  Â  Â  Â  finalStats.percentile = scores.length > 0 ? (scores.filter(s => s < scorePercent).length / scores.length) * 100 : 100;

Â  Â  Â  Â  Â  Â  Â  Â  const newTotalAttempts = data.totalAttempts + 1;

Â  Â  Â  Â  Â  Â  Â  Â  const newAverageScore = ((data.averageScore * data.totalAttempts) + scorePercent) / newTotalAttempts;

Â  Â  Â  Â  Â  Â  Â  Â  scores.push(scorePercent);

Â  Â  Â  Â  Â  Â  Â  Â  transaction.update(aggregatesRef, { totalAttempts: newTotalAttempts, averageScore: newAverageScore, scores });

Â  Â  Â  Â  Â  Â  Â  Â  finalStats.average = newAverageScore;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  });

Â  Â  } catch (e) { console.error("Transaction failed: ", e); }

Â  Â  return finalStats;

}



async function getAIInsights(incorrectQs) {

Â  Â  const insightsDiv = document.getElementById('ai-insights-content');

Â  Â  if (QUIZ_CONFIG.GOOGLE_AI_API_KEY === 'YOUR_API_KEY_HERE') {

Â  Â  Â  Â  insightsDiv.innerHTML = '<p>AI features are not enabled. Please add a Google AI API key.</p>'; return;

Â  Â  }

Â  Â  if(incorrectQs.length === 0) {

Â  Â  Â  Â  insightsDiv.innerHTML = '<p>Flawless victory! No incorrect answers to analyze.</p>'; return;

Â  Â  }

Â  Â  try {

Â  Â  Â  Â  const genAI = new GoogleGenerativeAI(QUIZ_CONFIG.GOOGLE_AI_API_KEY);

Â  Â  Â  Â  const model = genAI.getGenerativeModel({ model: "gemini-pro"});

Â  Â  Â  Â  const prompt = `A user answered these radiology fellowship exam questions incorrectly. Identify 2-3 core concepts they are struggling with and give concise, actionable study advice. Questions:\n${incorrectQs.map(q => `- ${q.text}`).join('\n')}`;

Â  Â  Â  Â  const result = await model.generateContent(prompt);

Â  Â  Â  Â  insightsDiv.innerHTML = result.response.text().replace(/\n/g, '<br>').replace(/\*/g, '');

Â  Â  } catch (error) {

Â  Â  Â  Â  insightsDiv.innerHTML = '<p>Could not retrieve AI insights at this time.</p>';

Â  Â  Â  Â  console.error("AI Error:", error);

Â  Â  }

}



function saveState() {

Â  Â  Â if (!currentUser || !currentPaper || isReviewing) return;

Â  Â  Â const state = { answers: userAnswers, index: currentQuestionIndex, elapsedSeconds: elapsedSeconds, flags: Array.from(flaggedQuestions) };

Â  Â  Â localStorage.setItem(`radmentor_quiz_fellowship_${currentUser.uid}_${currentPaper.id}_${quizMode}`, JSON.stringify(state));

}



function startTimer() {

Â  Â  clearInterval(quizInterval);

Â  Â  let startTime = Date.now() - (elapsedSeconds * 1000);

Â  Â  quizInterval = setInterval(() => {

Â  Â  Â  Â  elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);

Â  Â  Â  Â  dom.timerEl.textContent = `${String(Math.floor(elapsedSeconds/60)).padStart(2,'0')}:${String(elapsedSeconds%60).padStart(2,'0')}`;

Â  Â  }, 1000);

}



function setupReview(filterType) {

Â  Â  isReviewing = true;

Â  Â  if (filterType === 'all') {

Â  Â  Â  Â  reviewFilter = allQuestions.map((_, i) => i).filter(i => userAnswers[i] !== undefined);

Â  Â  } else if (filterType === 'incorrect') {

Â  Â  Â  Â  reviewFilter = allQuestions.map((q, i) => i).filter(i => userAnswers[i] !== undefined && userAnswers[i] !== q.correctIndex);

Â  Â  } else if (filterType === 'flagged') {

Â  Â  Â  Â  reviewFilter = allQuestions.map((q, i) => i).filter(i => flaggedQuestions.has(q.id));

Â  Â  }

Â  Â Â 

Â  Â  if (reviewFilter.length === 0) {

Â  Â  Â  Â  alert(`No ${filterType} questions to review.`);

Â  Â  Â  Â  isReviewing = false;

Â  Â  Â  Â  return;

Â  Â  }

Â  Â  dom.finishQuizBtn.style.display = 'none';

Â  Â  showScreen('quiz-screen');

Â  Â  createQuestionNav();

Â  Â  showQuestion(reviewFilter[0]);

}dashboard/quiz/quiz-engine.js



Got it. I have the quiz-engine.js file.






:root {

Â  Â  --bg-color: #f8fafc; --container-bg-color: #ffffff; --text-color: #475569; --text-color-light: #6b7280;

Â  Â  --header-text-color: #111827; --primary-color: #4f46e5; --primary-hover-color: #4338ca;

Â  Â  --border-color: #e5e7eb; --explanation-bg: #f9fafb; --correct-bg: #f0fdf4; --correct-border: #86efac;

Â  Â  --correct-text: #15803d; --incorrect-bg: #fef2f2; --incorrect-border: #fca5a5; --incorrect-text: #b91c1c;

Â  Â  --bookmark-color: #9ca3af; --bookmarked-color: #f59e0b; --flag-color: #9ca3af; --flagged-color: #ef4444;

}

body { font-family: 'Inter', sans-serif; margin: 0; padding: 1.5rem; background-color: var(--bg-color); color: var(--text-color); }

.main-container { width: 100%; max-width: 900px; margin: 0 auto; }

.screen { display: none; width: 100%; }

.screen.active { display: block; animation: fadeIn 0.5s; }

@keyframes fadeIn { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }

#authCheckScreen .selection-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 50vh; background: transparent; box-shadow: none; }

.loader { width: 40px; height: 40px; border: 4px solid var(--primary-color); border-bottom-color: transparent; border-radius: 50%; animation: rotation 1s linear infinite; }

@keyframes rotation { to { transform: rotate(360deg); } }

.selection-container { background-color: var(--container-bg-color); border-radius: 1.25rem; padding: 2rem; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }

.paper-button-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem; }

.paper-button { background-color: #f9fafb; color: var(--header-text-color); border: 1px solid var(--border-color); padding: 2rem; border-radius: 0.75rem; cursor: pointer; font-size: 1.25rem; font-weight: 700; transition: all 0.2s ease-in-out; }

.paper-button:hover { background-color: var(--primary-color); color: white; transform: translateY(-5px); box-shadow: 0 6px 15px rgba(79, 70, 229, 0.2); border-color: var(--primary-color); }

.quiz-container, .results-container { background-color: var(--container-bg-color); border-radius: 1.25rem; box-shadow: 0 6px 20px rgba(0,0,0,0.05); overflow: hidden; }

.quiz-header { padding: 1rem 1.25rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; gap: 1rem; }

.quiz-header h1 { font-size: 1.25rem; margin: 0; color: var(--header-text-color); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

.header-controls { display: flex; align-items: center; gap: 1rem; }

.timer { font-size: 1.1rem; font-weight: 600; color: var(--primary-color); background-color: #eef2ff; padding: 0.5rem 1rem; border-radius: 0.5rem; }

.mode-toggle { display: flex; align-items: center; gap: 0.75rem; font-size: 0.9rem; font-weight: 500; }

.switch { position: relative; display: inline-block; width: 50px; height: 28px; }

.switch input { opacity: 0; width: 0; height: 0; }

.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; border-radius: 28px; transition: 0.4s; }

.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; border-radius: 50%; transition: 0.4s; }

input:checked + .slider { background-color: var(--primary-color); }

input:checked + .slider:before { transform: translateX(22px); }

.question-area { padding: 1.5rem; }

.question-title-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }

.question-number { font-size: 1rem; font-weight: 500; color: var(--text-color-light); }

.question-controls { display: flex; gap: 1rem; }

.icon-btn { background: none; border: none; cursor: pointer; padding: 0; color: var(--text-color-light); transition: color 0.2s; }

.icon-btn:hover { color: var(--header-text-color); }

.icon-btn svg { width: 22px; height: 22px; }

.bookmark-btn.bookmarked { color: var(--bookmarked-color); }

.flag-btn.flagged { color: var(--flagged-color); }

.main-question-text { font-size: 1.2rem; font-weight: 600; line-height: 1.6; margin-bottom: 1.5rem; }

.option-btn { display: block; width: 100%; text-align: left; padding: 1rem; margin-bottom: 0.75rem; border: 1px solid var(--border-color); border-radius: 0.75rem; background-color: #f9fafb; cursor: pointer; transition: all 0.2s; }

.option-btn:hover { border-color: var(--primary-color); background-color: #eef2ff; }

.option-btn.selected { border-color: var(--primary-color); background-color: #eef2ff; font-weight: 600; }

.option-btn.correct { background-color: var(--correct-bg); border-color: var(--correct-border); color: var(--correct-text); font-weight: 600; }

.option-btn.incorrect { background-color: var(--incorrect-bg); border-color: var(--incorrect-border); color: var(--incorrect-text); font-weight: 600; }

.quiz-pagination-header { background-color: #f9fafb; padding: 1rem; border-bottom: 1px solid var(--border-color); overflow-x: auto; white-space: nowrap; scrollbar-width: thin; scrollbar-color: var(--primary-color) var(--border-color); }

.page-box { display: inline-flex; width: 40px; height: 40px; align-items: center; justify-content: center; font-weight: 600; background-color: #fff; border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s ease; border-radius: 0.5rem; position: relative; margin-right: 0.5rem; }

.page-box.active { border-color: var(--primary-color); background-color: var(--primary-color); color: white; transform: scale(1.1); }

.page-box.answered-correct { background-color: var(--correct-bg); border-color: var(--correct-border); color: var(--correct-text); }

.page-box.answered-incorrect { background-color: var(--incorrect-bg); border-color: var(--incorrect-border); color: var(--incorrect-text); }

.page-box.flagged::after { content: ''; position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background-color: var(--flagged-color); border-radius: 50%; }

.explanation-box { margin-top: 1.5rem; padding: 1.5rem; background-color: var(--explanation-bg); border-radius: 0.75rem; border-left: 4px solid var(--primary-color); }

.results-container { padding: 2rem; }

.results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }

.stat-card { background-color: #f9fafb; padding: 1.5rem; border-radius: 0.75rem; border: 1px solid var(--border-color); }

.stat-card h3 { font-size: 1.1rem; font-weight: 600; color: var(--header-text-color); border-bottom: 1px solid var(--border-color); padding-bottom: 0.75rem; margin-bottom: 1rem; }

.results-actions { text-align: center; margin-top: 2.5rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; }

.results-btn { padding: 0.75rem 1.5rem; font-weight: 600; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s; border: 1px solid transparent; text-decoration: none; display: inline-block; }

.results-btn.primary { background-color: var(--primary-color); color: white; }

.results-btn.primary:hover { background-color: var(--primary-hover-color); }

.results-btn.secondary { background-color: var(--container-bg-color); color: var(--text-color); border-color: var(--border-color); }

.results-btn.secondary:hover { background-color: var(--bg-color); }

.results-btn.danger { background-color: var(--incorrect-text); color: white; }

.results-btn.danger:hover { background-color: #991b1b; }

.results-btn.warning { background-color: var(--bookmarked-color); color: white; }

.results-btn.warning:hover { background-color: #d97706; }

.finish-btn-header { padding: 0.5rem 1.25rem; font-weight: 600; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s ease; border: 1px solid var(--primary-color); background-color: var(--primary-color); color: white; }

.finish-btn-header:hover { background-color: var(--primary-hover-color); border-color: var(--primary-hover-color); }dashboard/quiz/style.css these 3 codes work in perfect harmony



Got it. I have the style.css file.






now add all three into canvas without any change, all same lines


Here is the combined code for your web application, including the HTML, CSS, and JavaScript in a single, self-contained file.
Fellowship Exams Pro App
Aug 9, 1:08 AM

Open





dont give combined at all keep them seprate and as they were with same name and same location , now i want to debug that code



I've analyzed the code you provided and found several areas for improvement and debugging. I've separated the code back into its three original files, making the following changes to improve functionality and adherence to best practices:

Custom Modal UI: I have replaced all instances of alert() and confirm() with a custom modal UI. This is a crucial change as native browser dialogs are not supported in this environment and would prevent the application from working correctly.

HTML Structure: The HTML file had duplicate <title>, <h1>, and <div> tags which were causing rendering issues. I've cleaned these up to ensure a valid and logical document structure.

Event Handling: I've removed the onclick attributes from the dynamically generated HTML and centralized all event listeners within the JavaScript file, which is a more robust and maintainable approach.

Quiz Logic: The "Review All" button's functionality was flawed; it would only show answered questions. I have corrected the logic so that it correctly displays all questions for review.

Here are the updated files, ready for you to use.

dashboard/fellowship-exams.html

dashboard/quiz/quiz-engine.js
Quiz Engine JavaScript Module
Aug 9, 1:08 AM

Open

dashboard/quiz/style.css
Quiz Application Stylesheet
Aug 9, 1:08 AM

The main changes are the addition of a custom modal for user interactions and a fix to the "Review All" button logic. Let me know if you would like me to adjust the style or functionality of the new modal.










Video


Gemini can make mistakes, so double-check it

Quiz Application Stylesheet




262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970
.switchÂ {Â position:Â relative;Â display:Â inline-block;Â width:Â 50px;Â height:Â 28px;Â }.switchÂ inputÂ {Â opacity:Â 0;Â width:Â 0;Â height:Â 0;Â }.sliderÂ {Â position:Â absolute;Â cursor:Â pointer;Â top:Â 0;Â left:Â 0;Â right:Â 0;Â bottom:Â 0;Â background-color:Â Â #ccc;Â border-radius:Â 28px;Â transition:Â 0.4s;Â }.slider:beforeÂ {Â position:Â absolute;Â content:Â "";Â height:Â 20px;Â width:Â 20px;Â left:Â 4px;Â bottom:Â 4px;Â background-color:Â Â white;Â border-radius:Â 50%;Â transition:Â 0.4s;Â }input:checkedÂ +Â .sliderÂ {Â background-color:Â var(--primary-color);Â }input:checkedÂ +Â .slider:beforeÂ {Â transform:Â translateX(22px);Â }.question-areaÂ {Â padding:Â 1.5rem;Â }.question-title-barÂ {Â display:Â flex;Â justify-content:Â space-between;Â align-items:Â center;Â margin-bottom:Â 1rem;Â }.question-numberÂ {Â font-size:Â 1rem;Â font-weight:Â 500;Â color:Â var(--text-color-light);Â }.question-controlsÂ {Â display:Â flex;Â gap:Â 1rem;Â }.icon-btnÂ {Â background:Â none;Â border:Â none;Â cursor:Â pointer;Â padding:Â 0;Â color:Â var(--text-color-light);Â transition:Â colorÂ 0.2s;Â }.icon-btn:hoverÂ {Â color:Â var(--header-text-color);Â }.icon-btnÂ svgÂ {Â width:Â 22px;Â height:Â 22px;Â }.bookmark-btn.bookmarkedÂ {Â color:Â var(--bookmarked-color);Â }.flag-btn.flaggedÂ {Â color:Â var(--flagged-color);Â }.main-question-textÂ {Â font-size:Â 1.2rem;Â font-weight:Â 600;Â line-height:Â 1.6;Â margin-bottom:Â 1.5rem;Â }.option-btnÂ {Â display:Â block;Â width:Â 100%;Â text-align:Â left;Â padding:Â 1rem;Â margin-bottom:Â 0.75rem;Â border:Â 1pxÂ solidÂ var(--border-color);Â border-radius:Â 0.75rem;Â background-color:Â Â #f9fafb;Â cursor:Â pointer;Â transition:Â allÂ 0.2s;Â }.option-btn:hoverÂ {Â border-color:Â var(--primary-color);Â background-color:Â Â #eef2ff;Â }.option-btn.selectedÂ {Â border-color:Â var(--primary-color);Â background-color:Â Â #eef2ff;Â font-weight:Â 600;Â }.option-btn.correctÂ {Â background-color:Â var(--correct-bg);Â border-color:Â var(--correct-border);Â color:Â var(--correct-text);Â font-weight:Â 600;Â }.option-btn.incorrectÂ {Â background-color:Â var(--incorrect-bg);Â border-color:Â var(--incorrect-border);Â color:Â var(--incorrect-text);Â font-weight:Â 600;Â }.quiz-pagination-headerÂ {Â background-color:Â Â #f9fafb;Â padding:Â 1rem;Â border-bottom:Â 1pxÂ solidÂ var(--border-color);Â overflow-x:Â auto;Â white-space:Â nowrap;Â scrollbar-width:Â thin;Â scrollbar-color:Â var(--primary-color)Â var(--border-color);Â }.page-boxÂ {Â display:Â inline-flex;Â width:Â 40px;Â height:Â 40px;Â align-items:Â center;Â justify-content:Â center;Â font-weight:Â 600;Â background-color:Â Â #fff;Â border:Â 1pxÂ solidÂ var(--border-color);Â cursor:Â pointer;Â transition:Â allÂ 0.2sÂ ease;Â border-radius:Â 0.5rem;Â position:Â relative;Â margin-right:Â 0.5rem;Â }.page-box.activeÂ {Â border-color:Â var(--primary-color);Â background-color:Â var(--primary-color);Â color:Â Â white;Â transform:Â scale(1.1);Â }.page-box.answered-correctÂ {Â background-color:Â var(--correct-bg);Â border-color:Â var(--correct-border);Â color:Â var(--correct-text);Â }.page-box.answered-incorrectÂ {Â background-color:Â var(--incorrect-bg);Â border-color:Â var(--incorrect-border);Â color:Â var(--incorrect-text);Â }.page-box.flagged::afterÂ {Â content:Â '';Â position:Â absolute;Â top:Â 4px;Â right:Â 4px;Â width:Â 8px;Â height:Â 8px;Â background-color:Â var(--flagged-color);Â border-radius:Â 50%;Â }.explanation-boxÂ {Â margin-top:Â 1.5rem;Â padding:Â 1.5rem;Â background-color:Â var(--explanation-bg);Â border-radius:Â 0.75rem;Â border-left:Â 4pxÂ solidÂ var(--primary-color);Â }.results-containerÂ {Â padding:Â 2rem;Â }.results-gridÂ {Â display:Â grid;Â grid-template-columns:Â repeat(auto-fit,Â minmax(300px,Â 1fr));Â gap:Â 1.5rem;Â }.stat-cardÂ {Â background-color:Â Â #f9fafb;Â padding:Â 1.5rem;Â border-radius:Â 0.75rem;Â border:Â 1pxÂ solidÂ var(--border-color);Â }.stat-cardÂ h3Â {Â font-size:Â 1.1rem;Â font-weight:Â 600;Â color:Â var(--header-text-color);Â border-bottom:Â 1pxÂ solidÂ var(--border-color);Â padding-bottom:Â 0.75rem;Â margin-bottom:Â 1rem;Â }.results-actionsÂ {Â text-align:Â center;Â margin-top:Â 2.5rem;Â display:Â flex;Â flex-wrap:Â wrap;Â justify-content:Â center;Â gap:Â 1rem;Â }.results-btnÂ {Â padding:Â 0.75remÂ 1.5rem;Â font-weight:Â 600;Â border-radius:Â 0.5rem;Â cursor:Â pointer;Â transition:Â allÂ 0.2s;Â border:Â 1pxÂ solidÂ transparent;Â text-decoration:Â none;Â display:Â inline-block;Â }.results-btn.primaryÂ {Â background-color:Â var(--primary-color);Â color:Â Â white;Â }.results-btn.primary:hoverÂ {Â background-color:Â var(--primary-hover-color);Â }.results-btn.secondaryÂ {Â background-color:Â var(--container-bg-color);Â color:Â var(--text-color);Â border-color:Â var(--border-color);Â }.results-btn.secondary:hoverÂ {Â background-color:Â var(--bg-color);Â }.results-btn.dangerÂ {Â background-color:Â var(--incorrect-text);Â color:Â Â white;Â }.results-btn.danger:hoverÂ {Â background-color:Â Â #991b1b;Â }.results-btn.warningÂ {Â background-color:Â var(--bookmarked-color);Â color:Â Â white;Â }.results-btn.warning:hoverÂ {Â background-color:Â Â #d97706;Â }.finish-btn-headerÂ {Â padding:Â 0.5remÂ 1.25rem;Â font-weight:Â 600;Â border-radius:Â 0.5rem;Â cursor:Â pointer;Â transition:Â allÂ 0.2sÂ ease;Â border:Â 1pxÂ solidÂ var(--primary-color);Â background-color:Â var(--primary-color);Â color:Â Â white;Â }.finish-btn-header:hoverÂ {Â background-color:Â var(--primary-hover-color);Â border-color:Â var(--primary-hover-color);Â }
